<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>So you&#39;re learning OCaml... - Edgar Aroutiounian</title>
    <meta charset="utf-8" />
    <meta name="author" content="Edgar Aroutiounian" />
    <meta name="description" content="Help for OCaml beginners" />
    <meta name="keywords" content="OCaml, code" />
    <link rel="stylesheet" href="/media/css/main.css" type="text/css">
    <link rel="stylesheet" href="/media/css/prettify.css" type="text/css">
  </head>
  <body class="container">
    <div>
      <header class="masthead">
        <h1 class="masthead-title"><a href="/">Edgar Aroutiounian</a></h1>
        <p>Thoughts and Musings</p>
        <ul>
          <li><a href="/blog/">Blog</a></li>
          <li><a href="/tags/">Tags</a></li>
          <li><a href="/about/">About</a></li>
          <li><a href="http://github.com/fxfactorial">GitHub</a></li>
          <li><a href="/rss.xml">RSS</a></li>
        </ul>
        <form method="get" id="searchform" action="http://www.google.com/search">
          <input type="text" class="field" name="q" id="s" placeholder="Search">
          <input type="hidden" name="as_sitesearch" value="hyegar.com">
        </form>
      </header>
    </div>

<div>
<div class="post">
<h1>So you&#39;re learning OCaml...</h1>
<p>
Today was the first day of the Introduction to Functional Programming
in <code>OCaml</code> course, located <a href="https://www.france-universite-numerique-mooc.fr/courses/parisdiderot/56002/session01/about">here</a>. Apparently over 2,000 people signed up
and while doubtlessly many will drop out, there will still be 2,000
more programmers that are now aware of this amazing language called
<code>OCaml</code>.
</p>

<div id="outline-container-orgheadline1" class="outline-2">
<h2 id="orgheadline1">Crash course on the OCaml ecosystem.</h2>
<div class="outline-text-2" id="text-orgheadline1">
<p>
These are some key notes that you should know.
</p>

<ol class="org-ol">
<li><p>
<code>opam</code> is the package manager for OCaml. It is very advanced and
supports many features. The most basic of which is 
</p>

<div class="org-src-container">

<pre class="src src-shell">$ opam install &lt;some_package&gt;
</pre>
</div>

<p>
For people on <code>OS X</code>, you can get it on <code>brew</code> and all the <code>Linux</code>
distros should have <code>opam</code> for you to install. For Windows people,
get a VM. EDIT: To be clear, OCaml can build <b>native</b> executables on
Windows just fine, but opam doesn't work on this platform and for a
beginner you'll waste a lot of time with environment issues or
libraries that assume Unix.
</p></li>

<li><p>
Once you have <code>opam</code> installed, you probably want to do:
</p>

<div class="org-src-container">

<pre class="src src-shell">$ opam switch 4.02.3
</pre>
</div>

<p>
This will install the latest version of the compiler.
</p></li>

<li><code>ocamlfind</code> is a program that predates <code>opam</code> and wraps the
standard <code>OCaml</code> compilers: <code>ocamlc</code> and <code>ocamlopt</code>. The former is
a byte code compiler and the latter creates native code.</li>

<li><code>ocamlbuild</code> is a tool that helps build <code>OCaml</code> programs, many
people have strong opinions on it.</li>

<li><p>
<code>oasis</code> is a tool that helps abstract usage of 3, 4. I resisted it
for a while and wrote Makefiles instead, don't do that, just use
oasis. The oasis flow basically goes like this: (Be aware that
oasis is really finicky and its error messages are useless)
</p>

<p>
5.1) Create a directory.
</p>

<p>
5.2) Go to the directory and create a file named <b>_oasis</b> and
     directory named <code>src</code>
</p>

<p>
5.3) Here is a template of the contents of the <b>_oasis</b> file
</p>

<div class="org-src-container">

<pre class="src src-shell">OASISFormat:  0.4
OCamlVersion: &gt;= 4.02.3
Name:         opam_package_name
Version:      0.1
Maintainers:  New OCaml programmer
Homepage:     http://my_coolsite.com
Synopsis:     Some short description
Authors:      Cool@me.com
License:      BSD-3-clause
Plugins:      META (0.4), DevFiles (0.4)
AlphaFeatures: ocamlbuild_more_args

Description:
  Some cool description

# This is a comment and this below creates an binary program    
Executable &lt;some_program_name&gt;
  Path: src
  BuildTools:ocamlbuild
  install: true
  MainIs: main.ml
  CompiledObject: native
  BuildDepends: package_one, package_two

# Another comment, this builds a library called pg
Library pg
  Path:         src
  # oasis will figure out the dependencies, 
  # Just list the modules you want public, 
  # Note that there's no .ml, just give the name
  Modules:      Pg
  CompiledObject: byte
  BuildDepends: some_package
</pre>
</div>

<p>
5.4) Generate the Makefile, setup.ml, configure and other build crap.
</p>

<div class="org-src-container">

<pre class="src src-shell">$ oasis setup -setup-update dynamic
</pre>
</div>

<p>
5.5) Actually build your code, yes its just a call to make.
</p>

<div class="org-src-container">

<pre class="src src-shell">$ make
</pre>
</div>

<p>
5.6) You can stop here, but you can go even further with
     <code>oasis2opam</code>. Install it with: <code>opam install oasis2opam</code>, then
     in your project's root directory, aka the directory with the
     _oasis file, do: <code>oasis2opam --local</code>. This creates the <code>opam</code>
     directory and some meta data for the opam packaging
     system. Your local package can now be a first class citizen
     with opam just by doing this in the same project root
     directory: 
</p>

<div class="org-src-container">

<pre class="src src-shell">$ opam pin add &lt;your_package_name&gt; . -y
</pre>
</div></li>

<li><p>
<code>merlin</code> is a OCaml program that is simply amazing it drives code
completion for plugins available in <code>emacs</code> and <code>vim</code>. Once you
have merlin installed and running, add a <code>.merlin</code> file to your
project so that <code>merlin</code> knows what packages to code complete for,
a sample <code>.merlin</code> file looks like this:
</p>

<div class="org-src-container">

<pre class="src src-shell">B _build/src
S src
PKG cmdliner js_of_ocaml
</pre>
</div>

<p>
Notice how I put the <code>B _build/src</code> That sort of assumes you're
using <code>_oasis</code> and you made the <code>src</code> directory I mentioned earlier.
</p></li>

<li>There are no full blown IDEs for OCaml, learn <code>emacs</code> or
<code>vim</code>. EDIT: apparently <code>Sublime Text</code> has a merlin plugin, if
you're already familiar with Sublime Text then just stick with it,
merlin is really what matters here.</li>

<li><code>utop</code> is an enhanced repl, its better than the plain <code>ocaml</code>
   repl. Install it with <code>opam install utop</code></li>
</ol>
</div>
</div>

<div id="outline-container-orgheadline2" class="outline-2">
<h2 id="orgheadline2">Library situation</h2>
<div class="outline-text-2" id="text-orgheadline2">
<p>
<code>OCaml</code> does have a standard library but it sucks. It was only created
to serve the needs of the compiler programmers, ie its not like
<code>Python</code>'s standard library which has everything under the sun + the
moon. There are a few standard library replacements, one is called
<code>Core</code> and its provided by Jane Street. Its the library used in the
<b>Real World OCaml</b> book/website. Another standard library replacement
is called <code>Batteries</code>, this is more "community" supported. There is a
more recent contender called <code>Containers</code>. For a categorized list of
contemporary and well liked/must have libraries, checkout the
<a href="https://github.com/rizo/awesome-ocaml">awesome-ocaml</a> repository.
</p>
</div>
</div>

<div id="outline-container-orgheadline3" class="outline-2">
<h2 id="orgheadline3">Speaking of Libraries...</h2>
<div class="outline-text-2" id="text-orgheadline3">
<p>
This is "functional programming," so many of the real world libraries
you'll encounter will have Monadic interfaces, like <code>lwt</code> or Core's
<code>async</code>, both are asynchronous threading libraries, use Monads
and that wacky <code>&gt;&gt;=</code> function. But you really shouldn't fret about
what a Monad is or represents, just follow the type signature and
you'll be fine. For a more detailed treatment of Monads in OCaml and a
code example to talk to the <code>Stripe</code> API, see <a href="http://hyegar.com/blog/2015/09/23/let's-just-use-monads/">this</a>.
</p>
</div>
</div>

<div id="outline-container-orgheadline4" class="outline-2">
<h2 id="orgheadline4">Doing simple tasks (shameless plug)</h2>
<div class="outline-text-2" id="text-orgheadline4">
<p>
I try using <code>OCaml</code> for literally everything and that includes going
to hackathons, to make this less painful I wrote a library called
<code>Podge</code> which helps with simple stuff. I don't claim its a standard
library replacement, just a library for getting stuff done. These two
code samples assume the file is named <code>code.ml</code> and can be run with
<code>utop code.ml</code>
</p>

<p>
First install with opam:
</p>

<div class="org-src-container">

<pre class="src src-shell">$ opam install podge
</pre>
</div>

<ol class="org-ol">
<li>Reading output of a process</li>
</ol>

<div class="org-src-container">

<pre class="src src-ocaml">#require "podge"
let () = 
  Podge.Unix.read_process_output "ls -halt" |&gt; List.iter print_endline
</pre>
</div>

<p>
The <code>|&gt;</code> just means piping, its piping the output of
<code>read_process_output</code> into the input of the partially applied function
<code>iter</code>
</p>

<ol class="org-ol">
<li>Reading a file</li>
</ol>
<div class="org-src-container">

<pre class="src src-ocaml">#require "podge"
let () = 
  Podge.Unix.read_lines "code.ml" |&gt; List.iter print_endline
</pre>
</div>

<p>
Similar to 1, this reads all lines of file and gives it to the input
of the partially applied function <code>iter</code>.
</p>

<p>
These are two simple code samples from <code>Podge</code>, check out the <a href="https://github.com/fxfactorial/podge">repo</a>
for other useful modules like: (The README has code examples)
</p>

<ol class="org-ol">
<li><code>Web</code> for simple HTTP requests and getting data back as JSON,</li>
<li><code>Xml</code> for querying simple XML documents</li>
<li><code>ANSITerminal</code> for creating colored shell output</li>
<li><code>String</code> which is all due to <a href="http://rgrinberg.com/">Rudi Grinberg</a>.</li>
</ol>
</div>
</div>

<div id="outline-container-orgheadline5" class="outline-2">
<h2 id="orgheadline5">What can you do with it?</h2>
<div class="outline-text-2" id="text-orgheadline5">
<p>
Loads.
</p>

<ol class="org-ol">
<li>Compilers!, lots of compilers/compiler tools are written in
OCaml: Facebook uses OCaml for <a href="https://github.com/facebook/pfff">pfff</a> and <a href="https://github.com/facebook/flow">flow</a> and the first cut of
Rust was written in OCaml.</li>
<li>Financial world, <a href="https://www.janestreet.com/">Jane Street</a> uses OCaml for basically everything (AFAIK)</li>
<li>Systems Programming: <a href="https://ahrefs.com/">ahrefs</a>, my employer, uses OCaml for heavy
systems programming.</li>
<li>Kernels: Unikernels are hot right now, the most prominent one is
the <a href="https://mirage.io/">Mirage-OS</a> project and its all OCaml.</li>
<li>Shameless plug: I use OCaml as well for <code>js_of_ocaml</code>, in fact I'm
using it to write an Electron app with a node backend (All code is
OCaml compiled into JS, then run on node/Electron), see <a href="https://github.com/fxfactorial/ocaml-electron">here.</a></li>
<li>Genomics/Bioinformatics: <a href="https://github.com/hammerlab">Hammer Lab</a> in NYC uses OCaml for their
genomics/sequencing work.</li>
</ol>

<p>
...And I'm sure there's more I haven't mentioned...
</p>
</div>
</div>

<div id="outline-container-orgheadline6" class="outline-2">
<h2 id="orgheadline6">Stick with it!</h2>
<div class="outline-text-2" id="text-orgheadline6">
<p>
This style of coding might be new to you or maybe its your first
programming language, stick with it and continue. <code>OCaml</code> offers many
awesome features and has many strengths including a very professional
and pragmatic community.
</p>
</div>
</div>

</div>
</div>
    <div>
      <div class="post-meta">
        <span title="post date" class="post-info">2015-10-19</span>
        <span title="last modification date" class="post-info">2015-10-20</span>
        <span title="tags" class="post-info"><a href="/tags/ocaml/">OCaml</a>, <a href="/tags/code/">code</a></span>
        <span title="author" class="post-info">Edgar Aroutiounian</span>
      </div>
      <section>
        <h1>Comments</h1>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          //var disqus_developer = 1;
          var disqus_identifier = "/blog/2015/10/19/so-you&#39;re-learning-ocaml";
          var disqus_url = "http://hyegar.com/blog/2015/10/19/so-you&#39;re-learning-ocaml";
          var disqus_shortname = 'hyegar';
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </section>
      <script src="http://code.jquery.com/jquery-latest.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.js"></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="/media/js/main.js"></script>
      <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-57031124-1']);
        _gaq.push(['_trackPageview']);
        (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      </script>
      <div class="footer">
        <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.x (<a href="http://orgmode.org">Org mode</a> 8.x)</p>
        <p>
          Copyright &copy; 2012 - <span id="footerYear"></span> <a href="mailto:edgar &lt;dot&gt; factorial &lt;at&gt; gmail &lt;dot&gt; com">Edgar Aroutiounian</a>
          &nbsp;&nbsp;-&nbsp;&nbsp;
          Powered by <a href="https://github.com/kelvinh/org-page" target="_blank">org-page</a>
          <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
        </p>
      </div>
    </div>

  </body>
</html>
